<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../favicon.png" />
		<meta name="viewport" content="width=device-width" />
		<meta name="keywords" content="robotics,ftc,jamaica,jamaicacollege" />
		<meta name="robot" content="index/follow" />
		<meta
			name="description"
			content="Jamaica College's Robotics teams"
		/>
		<meta name="google-site-verification" content="5ZE9_Y0Fjfd9FTy5OOOlMf74oaAyf4x7KfTG4TGzdC0" />
		<meta http-equiv="content-security-policy" content="">
		<link href="../../_app/immutable/assets/_layout-62ade677.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/_page-1272daef.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/start-beab0780.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index-c1eee52a.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/singletons-d2c7d002.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/preload-helper-28b7b303.js">
		<link rel="modulepreload" href="../../_app/immutable/components/pages/_layout.svelte-e0f59698.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/navigation-4690da67.js">
		<link rel="modulepreload" href="../../_app/immutable/modules/pages/_layout.ts-b8ee4d7c.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/_layout-1daba58d.js">
		<link rel="modulepreload" href="../../_app/immutable/components/pages/resources/blog/_slug_/_page.svelte-78943854.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/profiles-faf00542.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index-6203779a.js"><title>JC Robotics</title>
		<style>
			@import '@fontsource/bebas-neue';
			@import '@fontsource/montserrat';

			@tailwind base;
			@tailwind components;
			@tailwind utilities;

			* {
				margin: 0;
				padding: 0;
			}

			body {
				min-height: 100vh;
				max-width: 100vw;
			}

			.prose p {
				font-family: 'Montserrat', sans-serif !important;
			}
		</style>
	</head>
	<body data-sveltekit-prefetch>
		<div class="app">




<nav class="relative container flex justify-between tracking-[0.065em] mb-12 px-10"><div class="flex items-center justify-between w-full">
		<div class="flex justify-center gap-3"><img class="hidden w-8 aspect-square md:flex" src="/_app/immutable/assets/jc-logo-d894bf84.png" alt="JC Logo">

			<h1 class="pl-4 md:p-0 group block pt-2 font-heading font-extrabold uppercase text-3xl relative"><a href="/" class="no-underline group-hover:underline">JC Robotics </a>
				<span class="absolute w-full h-2 rounded-full scale-0 bg-blue-900 group-hover:scale-1"></span></h1></div>

		
<ul class="hidden md:flex w-1/2 justify-around bg-bangladesh-green text-cornsilk text-xl font-bebas-neue rounded-b-sm"><li class="flex "><a class="relative transistion duration-200 p-6 capitalize after:bg-accent isolate after:z-[-10] | link svelte-zhbz9u" href="/">home</a></li><li class="flex "><a class="relative transistion duration-200 p-6 capitalize after:bg-accent isolate after:z-[-10] | link svelte-zhbz9u" href="/resources/blog">blog</a></li><li class="flex "><a class="relative transistion duration-200 p-6 capitalize after:bg-accent isolate after:z-[-10] | link svelte-zhbz9u" href="/about">about</a></li>
</ul>

		
<div class="relative md:hidden w-6 h-5"><div class="absolute inset-0 flex flex-col justify-between -translate-x-5"><span class="origin-top-left relative transistion ease-out duration-300 w-full h-1/4 bg-white rounded-full false"></span>
		<span class="relative transistion ease-out duration-300 w-full h-1/4 bg-white rounded-full translate-x-1 false"></span>
		<span class="origin-bottom-left relative transistion ease-out duration-300 w-full h-1/4 bg-white rounded-full false"></span></div></div>
		
<ul class="transistion right:0 duration-300 ease-in-out md:hidden flex flex-col absolute w-[80%] mt-50 font-bold bg-primary items-center text-cornsilk text-2xl rounded-md font-bebas-neue top-0  drop-shadow-xl py-6 translate-y-16 left-[50%] -translate-x-[50%] -translate-y-96 z-[10000]"><li class="w-full flex justify-center"><a class="w-full flex justify-center py-3 hover:bg-accent" href="/">home</a>
	</li><li class="w-full flex justify-center"><a class="w-full flex justify-center py-3 hover:bg-accent" href="/resources/blog">blog</a>
	</li><li class="w-full flex justify-center"><a class="w-full flex justify-center py-3 hover:bg-accent" href="/about">about</a>
	</li></ul></div></nav>



<article class="prose lg:prose-xl max-w-full px-10 m-auto my-4 sm:my-16 svelte-5sqr0x"><img class="rounded-md" alt="blog post">
	<h1>Programming Mecanum Wheels</h1>
	<p>Published: 11 December 2022</p>
	<p>By: Orville Daley</p>

	<h2 id="the-physics-of-mecanum">The Physics of Mecanum</h2><p>Mecanum wheels are a unique kind of wheel that, in contrast to conventional wheels, allow for mobility and holonomic strafing. They are made up of a number of rubber rollers that have been turned 45 degrees to the left or right.</p><p>In a typical mecanum drivetrain, sideways motion is produced by turning the wheels on one diagonal in the opposite direction from the wheels on the other diagonal. These wheel motions may be combined to move the vehicle in any direction and make it rotate in any direction.</p><p>The four mecanum wheels in a typical mecanum drive system are arranged in a "X" pattern. This indicates that when viewed from above, the rollers are inclined toward the center. The force vectors generated by the offset rollers can be summed and equations for movements in all directions can be derived. </p><p><!-- HTML_TAG_START --><img src="https://gm0.org/en/latest/_images/mecanum-drive-force-diagram.png" alt="Mecanum Drivetrain"
style="margin: auto" /><!-- HTML_TAG_END --></p><p>Vectors 1, 2, 3, and 4 in the figure above represent the force vectors produced by the mecanum wheels when the chassis is told to move toward the top of the picture. Every motor is moving ahead. Their X and Y components are shown by the blue and red lines, respectively.</p><blockquote><p><strong>Note</strong>
DO NOT HARDCODE THE WHEEL MOVEMENTS, THESE CAN BE PROGRAMMATICALLY COMPUTED</p></blockquote><blockquote><p><strong>Note</strong>
It is important to note that because of friction, perfect movement isn’t possible in every direction.</p></blockquote><h2 id="deriving-mecanum-control-equations">Deriving Mecanum Control Equations</h2><h4 id="direction">Direction</h4><p>Joysticks can be used to input x and y coordinates. You're interested in the direction the joystick is pointing. This may be done by determining the inverse tangent of y/x. Angles outside the first quadrant of the unit circle must be corrected. Fortunately, you may avoid this problem by substituting the function "atan2" for the common "atan" used in most programming languages.</p><pre class="python"><code>    SET x TO gamepad.left_stick_x
    SET y TO -gamepad.left_stick_y  #The y axis of the joystick is flipped with regards to the cartesian plane.

    SET theta TO ATAN2( y, x )</code></pre><h4 id="magnitude">Magnitude</h4><p>To identify the direction the joystick was pointing, you used trigonometry. The magnitude is determined by finding the hypotenuse of the same triangle. The simplest approach is the Pythagorean theorem, which says that a+b+c=2. By multiplying the square root of the joystick's x and y coordinates, it is possible to determine the length of the hypotenuse.</p><h4 id="adding-turn">Adding Turn</h4><p>Most of the work has been done at this point, everything just needs to be put together and a few tweaks need to be made. The code you write should use the joystick x and y to obtain an angle, and the length of the hypotenuse of the triangle that the x and y coordinates make (the magnitude).</p><p>Now the robot has the ability to move laterally in any direction—almost. For most robots, in order to work right, the 2 wheels on one side of the robot need to be inverted because they face the opposite direction. </p><blockquote><p><strong>Note</strong>
Set one side of the robot’s wheels to be. If after inverting the right wheels the robot is always going backwards then try inverting the left side instead.</p></blockquote><p>Finally, the robot can move laterally and only needs to rotate. Fortunately, the robot can be easilyg horizontal movement t programmed to turn, even at the same time as it’s driving. We will use a second joystick for this purpose, usino turn the robot (the x-axis).</p><p>Actually, it's rather simple. If the turn value is applied to the lateral movement value, each wheel will turn smoothly. A motor controller can only take values up to 1 (or -1), which is the only problem. Any larger value just scales down to 1, which will have an impact on our outcomes - distorting the robot’s movements.</p><p>In order to make the largest number one, all must be scaled by the same amount. The absolute value of the biggest (or smallest, if on the negative side) number is what makes this factor simple to find. The drive will function now if you simply divide the value for each wheel by this factor.</p><h2 id="the-pseudocode">The Pseudocode</h2><pre class="python"><code>START
    # Remember one side of the robot's wheel should be reversed


    SET x TO gamepad.left_stick_x
    SET y TO -gamepad.left_stick_y # The y axis of the joystick is flipped with regards to the cartesian plane.

    SET turn TO gamepad.right_stick_x

    SET theta TO ATAN2( x, y ) - PI/4 # Get the angle of the polar coordinates for (x,y). Translate -45 degrees
    power &lt;- square root of (x^2 + y^2) # Get the length of the hypotenuse
    
    
    SET leftFront to power * COS(theta) + turn
    SET rightFront to power * SIN(theta) - turn
    SET leftBack to power * SIN(theta) + turn
    SET rightBack to power * COS(theta) - turn

    
    # Scale all values to be in range [1,-1]
    SET max TO MAX( ABSOLUTE( leftFront, rightFront, leftBack, rightBack ) )
 
    SET leftFront to leftFront / max
    SET rightFront to rightFront / max
    SET leftBack to leftBack / max
    SET rightBackto rightBack / max


STOP.</code></pre><h3 id="citations-and-additional-resources">Citations and Additional Resources</h3><pre class=""><code>https://www.youtube.com/watch?v=gnSW2QpkGXQ
https://www.youtube.com/watch?v=Xrc0l4TDnyw
https://www.youtube.com/watch?v=Ne09Y72zW_Y
https://seamonsters-2605.github.io/archive/mecanum/
https://ftcforum.usfirst.org/forum/ftc-technology/android-studio/6361-mecanum-wheels-drive-code-example
https://www.tutorialspoint.com/java/number_atan2.htm
http://thinktank.wpi.edu/resources/346/ControllingMecanumDrive.pdf</code></pre>
</article>


		<script type="module" data-sveltekit-hydrate="v2jh4f">
			import { start } from "../../_app/immutable/start-beab0780.js";

			start({
				env: {},
				hydrate: {
					status: 200,
					error: null,
					node_ids: [0, 8],
					params: {slug:"programming-mecannum-wheels"},
					route: {"id":"/resources/blog/[slug]"},
					data: [null,{type:"data",data:{metadata:{authorId:"orville-daley",slug:"programming-mecannum-wheels",tags:["programming","robot","drivetrain","chassis"],title:"Programming Mecanum Wheels",imageUrl:"mecanum",datePublished:"11 December 2022",readTime:"5"},content:"## The Physics of Mecanum\nMecanum wheels are a unique kind of wheel that, in contrast to conventional wheels, allow for mobility and holonomic strafing. They are made up of a number of rubber rollers that have been turned 45 degrees to the left or right.\n\nIn a typical mecanum drivetrain, sideways motion is produced by turning the wheels on one diagonal in the opposite direction from the wheels on the other diagonal. These wheel motions may be combined to move the vehicle in any direction and make it rotate in any direction.\n\nThe four mecanum wheels in a typical mecanum drive system are arranged in a \"X\" pattern. This indicates that when viewed from above, the rollers are inclined toward the center. The force vectors generated by the offset rollers can be summed and equations for movements in all directions can be derived. \n\n\u003Cimg src=\"https:\u002F\u002Fgm0.org\u002Fen\u002Flatest\u002F_images\u002Fmecanum-drive-force-diagram.png\" alt=\"Mecanum Drivetrain\"\nstyle=\"margin: auto\" \u002F\u003E\n\nVectors 1, 2, 3, and 4 in the figure above represent the force vectors produced by the mecanum wheels when the chassis is told to move toward the top of the picture. Every motor is moving ahead. Their X and Y components are shown by the blue and red lines, respectively.\n\n\u003E **Note**\n\u003E DO NOT HARDCODE THE WHEEL MOVEMENTS, THESE CAN BE PROGRAMMATICALLY COMPUTED\n\n\u003E **Note**\n\u003E It is important to note that because of friction, perfect movement isn’t possible in every direction.\n\n## Deriving Mecanum Control Equations\n\n#### Direction\nJoysticks can be used to input x and y coordinates. You're interested in the direction the joystick is pointing. This may be done by determining the inverse tangent of y\u002Fx. Angles outside the first quadrant of the unit circle must be corrected. Fortunately, you may avoid this problem by substituting the function \"atan2\" for the common \"atan\" used in most programming languages.\n\n```python\n\tSET x TO gamepad.left_stick_x\n\tSET y TO -gamepad.left_stick_y  #The y axis of the joystick is flipped with regards to the cartesian plane.\n\n\tSET theta TO ATAN2( y, x )\n```\n#### Magnitude\nTo identify the direction the joystick was pointing, you used trigonometry. The magnitude is determined by finding the hypotenuse of the same triangle. The simplest approach is the Pythagorean theorem, which says that a+b+c=2. By multiplying the square root of the joystick's x and y coordinates, it is possible to determine the length of the hypotenuse.\n\n#### Adding Turn\nMost of the work has been done at this point, everything just needs to be put together and a few tweaks need to be made. The code you write should use the joystick x and y to obtain an angle, and the length of the hypotenuse of the triangle that the x and y coordinates make (the magnitude).\n\nNow the robot has the ability to move laterally in any direction—almost. For most robots, in order to work right, the 2 wheels on one side of the robot need to be inverted because they face the opposite direction. \n\n\u003E **Note**\n\u003E Set one side of the robot’s wheels to be. If after inverting the right wheels the robot is always going backwards then try inverting the left side instead.\n\nFinally, the robot can move laterally and only needs to rotate. Fortunately, the robot can be easilyg horizontal movement t programmed to turn, even at the same time as it’s driving. We will use a second joystick for this purpose, usino turn the robot (the x-axis).\n\nActually, it's rather simple. If the turn value is applied to the lateral movement value, each wheel will turn smoothly. A motor controller can only take values up to 1 (or -1), which is the only problem. Any larger value just scales down to 1, which will have an impact on our outcomes - distorting the robot’s movements.\n\nIn order to make the largest number one, all must be scaled by the same amount. The absolute value of the biggest (or smallest, if on the negative side) number is what makes this factor simple to find. The drive will function now if you simply divide the value for each wheel by this factor.\n\n## The Pseudocode\n``` python\nSTART\n\t# Remember one side of the robot's wheel should be reversed\n\n\n\tSET x TO gamepad.left_stick_x\n\tSET y TO -gamepad.left_stick_y # The y axis of the joystick is flipped with regards to the cartesian plane.\n\n\tSET turn TO gamepad.right_stick_x\n\n\tSET theta TO ATAN2( x, y ) - PI\u002F4 # Get the angle of the polar coordinates for (x,y). Translate -45 degrees\n\tpower \u003C- square root of (x^2 + y^2) # Get the length of the hypotenuse\n\t\n\t\n\tSET leftFront to power * COS(theta) + turn\n\tSET rightFront to power * SIN(theta) - turn\n\tSET leftBack to power * SIN(theta) + turn\n\tSET rightBack to power * COS(theta) - turn\n\n\t\n\t# Scale all values to be in range [1,-1]\n\tSET max TO MAX( ABSOLUTE( leftFront, rightFront, leftBack, rightBack ) )\n \n\tSET leftFront to leftFront \u002F max\n\tSET rightFront to rightFront \u002F max\n\tSET leftBack to leftBack \u002F max\n\tSET rightBackto rightBack \u002F max\n\n\nSTOP.\n```\n\n### Citations and Additional Resources\n\n```\nhttps:\u002F\u002Fwww.youtube.com\u002Fwatch?v=gnSW2QpkGXQ\nhttps:\u002F\u002Fwww.youtube.com\u002Fwatch?v=Xrc0l4TDnyw\nhttps:\u002F\u002Fwww.youtube.com\u002Fwatch?v=Ne09Y72zW_Y\nhttps:\u002F\u002Fseamonsters-2605.github.io\u002Farchive\u002Fmecanum\u002F\nhttps:\u002F\u002Fftcforum.usfirst.org\u002Fforum\u002Fftc-technology\u002Fandroid-studio\u002F6361-mecanum-wheels-drive-code-example\nhttps:\u002F\u002Fwww.tutorialspoint.com\u002Fjava\u002Fnumber_atan2.htm\nhttp:\u002F\u002Fthinktank.wpi.edu\u002Fresources\u002F346\u002FControllingMecanumDrive.pdf\n```"},uses:{params:["slug"]}}],
					form: null
				},
				paths: {"base":"","assets":""},
				target: document.querySelector('[data-sveltekit-hydrate="v2jh4f"]').parentNode,
				trailing_slash: "never"
			});
		</script>
	</div>
	</body>
</html>
